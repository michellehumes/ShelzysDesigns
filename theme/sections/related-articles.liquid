{%- comment -%}
  Related Articles Section
{%- endcomment -%}

{%- if blog.articles.size > 1 -%}
  <section class="related-articles-section section-padding" style="background: #F7F4EF;">
    <div class="container">
      <div class="section-header">
        <h2>{{ section.settings.heading }}</h2>
      </div>

      <div class="blog-grid">
        {%- for post in blog.articles limit: section.settings.posts_to_show -%}
          {%- unless post.id == article.id -%}
            <article class="blog-card">
              {%- if post.image -%}
                <a href="{{ post.url }}" class="blog-card__image">
                  <img
                    src="{{ post.image | image_url: width: 600, height: 400, crop: 'center' }}"
                    alt="{{ post.image.alt | default: post.title | escape }}"
                    loading="lazy"
                  >
                </a>
              {%- endif -%}

              <div class="blog-card__content">
                <h3 class="blog-card__title">
                  <a href="{{ post.url }}">{{ post.title }}</a>
                </h3>
                <p class="blog-card__excerpt">
                  {{ post.excerpt_or_content | strip_html | truncate: 100 }}
                </p>
                <a href="{{ post.url }}" class="blog-card__link">Read More</a>
              </div>
            </article>
          {%- endunless -%}
        {%- endfor -%}
      </div>
    </div>
  </section>
{%- endif -%}

{% schema %}
{
  "name": "Related Articles",
  "tag": "section",
  "class": "section-related-articles",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "More Articles"
    },
    {
      "type": "range",
      "id": "posts_to_show",
      "label": "Posts to show",
      "min": 2,
      "max": 6,
      "step": 1,
      "default": 3
    }
  ]
}
{% endschema %}
