{%- comment -%}
  Shelzy's Designs - 404 Error Page

  Custom branded 404 page to keep customers engaged and help them
  find what they're looking for. Includes helpful navigation and
  search functionality.
{%- endcomment -%}

{%- comment -%} SEO: Tell search engines not to index 404 pages {%- endcomment -%}
{% capture seo_meta %}
  <meta name="robots" content="noindex, nofollow">
{% endcapture %}
{% assign content_for_header = content_for_header | append: seo_meta %}

{%- comment -%} Structured Data for 404 Page {%- endcomment -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Page Not Found - {{ shop.name }}",
  "description": "The page you're looking for could not be found.",
  "url": "{{ request.origin }}{{ request.path }}",
  "isPartOf": {
    "@type": "WebSite",
    "name": "{{ shop.name }}",
    "url": "{{ request.origin }}"
  },
  "breadcrumb": {
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "{{ request.origin }}"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Page Not Found"
      }
    ]
  }
}
</script>

{%- comment -%} Analytics: Track 404 errors for debugging {%- endcomment -%}
<script>
  if (typeof window.dataLayer !== 'undefined') {
    window.dataLayer.push({
      'event': '404_error',
      'page_path': window.location.pathname,
      'referrer': document.referrer
    });
  }
  // Console log for debugging in development
  console.warn('404 Error:', {
    path: window.location.pathname,
    referrer: document.referrer,
    timestamp: new Date().toISOString()
  });
</script>

<div class="sz-error-page">
  <div class="sz-error-container">

    {%- comment -%} Error Message {%- endcomment -%}
    <div class="sz-error-content">
      <div class="sz-error-icon">
        <svg width="120" height="120" viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="60" cy="60" r="58" stroke="var(--sz-primary)" stroke-width="4" stroke-dasharray="8 4"/>
          <path d="M60 35V65M60 75V85" stroke="var(--sz-primary)" stroke-width="6" stroke-linecap="round"/>
        </svg>
      </div>

      <h1 class="sz-error-title">Oops! Page Not Found</h1>
      <p class="sz-error-subtitle">
        We couldn't find the page you're looking for. It may have been moved,
        removed, or the link might be incorrect.
      </p>

      {%- comment -%} Search Form {%- endcomment -%}
      <div class="sz-error-search">
        <form action="/search" method="get" class="sz-search-form">
          <input
            type="text"
            name="q"
            placeholder="Search for products..."
            class="sz-search-input"
            aria-label="Search products"
          >
          <button type="submit" class="sz-search-btn" aria-label="Search">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"/>
              <path d="M21 21l-4.35-4.35"/>
            </svg>
          </button>
        </form>
      </div>

      {%- comment -%} Helpful Links {%- endcomment -%}
      <div class="sz-error-links">
        <p class="sz-error-links-heading">Here are some helpful links:</p>
        <ul class="sz-error-nav">
          <li><a href="/">Go to Homepage</a></li>
          <li><a href="/collections/all">Browse All Products</a></li>
          <li><a href="/collections/best-sellers">Shop Best Sellers</a></li>
          <li><a href="/pages/contact">Contact Us</a></li>
        </ul>
      </div>

      {%- comment -%} CTA Buttons {%- endcomment -%}
      <div class="sz-error-cta">
        <a href="/" class="sz-btn sz-btn-primary">Back to Home</a>
        <a href="/collections/all" class="sz-btn sz-btn-secondary">Shop All Products</a>
      </div>
    </div>

    {%- comment -%} Featured Products Section {%- endcomment -%}
    <div class="sz-error-featured">
      <h2 class="sz-error-featured-title">Popular Products You Might Like</h2>
      <div class="sz-error-products">
        {%- assign featured_products = collections['best-sellers'].products | default: collections.all.products -%}
        {%- for product in featured_products limit: 4 -%}
          <div class="sz-error-product-card">
            <a href="{{ product.url }}" class="sz-error-product-link">
              <div class="sz-error-product-image">
                {%- if product.featured_image -%}
                  <img
                    src="{{ product.featured_image | image_url: width: 300 }}"
                    alt="{{ product.title }}"
                    loading="lazy"
                  >
                {%- else -%}
                  <div class="sz-error-product-placeholder">{{ product.title | truncate: 20 }}</div>
                {%- endif -%}
              </div>
              <div class="sz-error-product-info">
                <h3 class="sz-error-product-title">{{ product.title }}</h3>
                <span class="sz-error-product-price">{{ product.price | money }}</span>
              </div>
            </a>
          </div>
        {%- endfor -%}
      </div>
    </div>

  </div>
</div>

<style>
  /* ═══════════════════════════════════════════════════════════════════
     404 ERROR PAGE STYLES
     ═══════════════════════════════════════════════════════════════════ */
  .sz-error-page {
    padding: var(--sz-space-2xl) var(--sz-space-md);
    background: var(--sz-warm-white);
    min-height: 60vh;
  }

  .sz-error-container {
    max-width: 1000px;
    margin: 0 auto;
  }

  .sz-error-content {
    text-align: center;
    padding: var(--sz-space-2xl) 0;
  }

  .sz-error-icon {
    margin-bottom: var(--sz-space-xl);
  }

  .sz-error-title {
    font-family: var(--sz-font-heading);
    font-size: clamp(2rem, 5vw, 3rem);
    font-weight: 600;
    color: var(--sz-primary-dark);
    margin: 0 0 var(--sz-space-md) 0;
  }

  .sz-error-subtitle {
    font-family: var(--sz-font-body);
    font-size: var(--sz-text-lg);
    color: var(--sz-charcoal);
    max-width: 500px;
    margin: 0 auto var(--sz-space-xl);
    line-height: 1.6;
  }

  /* Search Form */
  .sz-error-search {
    max-width: 400px;
    margin: 0 auto var(--sz-space-xl);
  }

  .sz-search-form {
    display: flex;
    border: 2px solid var(--sz-border-light);
    border-radius: var(--sz-radius-full);
    overflow: hidden;
    background: var(--sz-white);
  }

  .sz-search-form:focus-within {
    border-color: var(--sz-primary);
  }

  .sz-search-input {
    flex: 1;
    padding: var(--sz-space-md) var(--sz-space-lg);
    border: none;
    font-family: var(--sz-font-body);
    font-size: var(--sz-text-base);
    outline: none;
  }

  .sz-search-btn {
    padding: var(--sz-space-md) var(--sz-space-lg);
    background: var(--sz-primary);
    border: none;
    color: var(--sz-white);
    cursor: pointer;
    transition: background var(--sz-transition-fast);
  }

  .sz-search-btn:hover {
    background: var(--sz-primary-dark);
  }

  /* Helpful Links */
  .sz-error-links {
    margin-bottom: var(--sz-space-xl);
  }

  .sz-error-links-heading {
    font-family: var(--sz-font-body);
    font-size: var(--sz-text-sm);
    font-weight: 500;
    color: var(--sz-gray);
    margin-bottom: var(--sz-space-md);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .sz-error-nav {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--sz-space-md) var(--sz-space-lg);
  }

  .sz-error-nav a {
    font-family: var(--sz-font-body);
    font-size: var(--sz-text-base);
    color: var(--sz-primary);
    text-decoration: none;
    font-weight: 500;
    transition: color var(--sz-transition-fast);
  }

  .sz-error-nav a:hover {
    color: var(--sz-primary-dark);
    text-decoration: underline;
  }

  /* CTA Buttons */
  .sz-error-cta {
    display: flex;
    justify-content: center;
    gap: var(--sz-space-md);
    flex-wrap: wrap;
  }

  /* Featured Products */
  .sz-error-featured {
    margin-top: var(--sz-space-3xl);
    padding-top: var(--sz-space-2xl);
    border-top: 1px solid var(--sz-border-light);
  }

  .sz-error-featured-title {
    font-family: var(--sz-font-heading);
    font-size: var(--sz-text-2xl);
    font-weight: 600;
    color: var(--sz-primary-dark);
    text-align: center;
    margin: 0 0 var(--sz-space-xl) 0;
  }

  .sz-error-products {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--sz-space-lg);
  }

  @media (max-width: 900px) {
    .sz-error-products {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 500px) {
    .sz-error-products {
      grid-template-columns: 1fr;
      max-width: 300px;
      margin: 0 auto;
    }
  }

  .sz-error-product-card {
    background: var(--sz-white);
    border-radius: var(--sz-radius-md);
    overflow: hidden;
    transition: box-shadow var(--sz-transition-normal);
  }

  .sz-error-product-card:hover {
    box-shadow: var(--sz-shadow-md);
  }

  .sz-error-product-link {
    text-decoration: none;
    color: inherit;
    display: block;
  }

  .sz-error-product-image {
    aspect-ratio: 1;
    background: var(--sz-beige);
    overflow: hidden;
  }

  .sz-error-product-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--sz-transition-normal);
  }

  .sz-error-product-card:hover .sz-error-product-image img {
    transform: scale(1.05);
  }

  .sz-error-product-placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: var(--sz-text-sm);
    color: var(--sz-gray);
    padding: var(--sz-space-md);
    text-align: center;
  }

  .sz-error-product-info {
    padding: var(--sz-space-md);
    text-align: center;
  }

  .sz-error-product-title {
    font-family: var(--sz-font-body);
    font-size: var(--sz-text-sm);
    font-weight: 500;
    color: var(--sz-charcoal);
    margin: 0 0 var(--sz-space-xs) 0;
    line-height: 1.3;
  }

  .sz-error-product-price {
    font-family: var(--sz-font-body);
    font-size: var(--sz-text-sm);
    font-weight: 600;
    color: var(--sz-primary-dark);
  }
</style>
