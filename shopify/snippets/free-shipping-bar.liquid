{% comment %}
  Free Shipping Progress Bar
  Installation: Add {% render 'free-shipping-bar' %} in cart drawer/page
  Note: Threshold is $75
{% endcomment %}

{% assign free_shipping_threshold = 75 %}
{% assign cart_total = cart.total_price | divided_by: 100.0 %}
{% assign remaining = free_shipping_threshold | minus: cart_total %}
{% assign progress_percent = cart_total | divided_by: free_shipping_threshold | times: 100 %}

{% if progress_percent > 100 %}
  {% assign progress_percent = 100 %}
{% endif %}

<style>
  .shelzy-shipping-bar {
    padding: 16px;
    background: #faf9f7;
    border-radius: 8px;
    margin-bottom: 16px;
  }

  .shelzy-shipping-text {
    font-size: 14px;
    color: #333;
    margin-bottom: 10px;
    text-align: center;
  }

  .shelzy-shipping-text strong {
    color: #321004;
  }

  .shelzy-shipping-progress {
    height: 8px;
    background: #e5e5e5;
    border-radius: 4px;
    overflow: hidden;
  }

  .shelzy-shipping-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #321004, #5a3825);
    border-radius: 4px;
    transition: width 0.3s ease;
  }

  .shelzy-shipping-success {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    color: #16a34a;
    font-weight: 600;
  }

  .shelzy-shipping-success svg {
    width: 20px;
    height: 20px;
  }
</style>

<div class="shelzy-shipping-bar">
  {% if cart_total >= free_shipping_threshold %}
    <div class="shelzy-shipping-success">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
      </svg>
      <span>You've unlocked FREE shipping!</span>
    </div>
  {% else %}
    <div class="shelzy-shipping-text">
      You're <strong>{{ remaining | money }}</strong> away from FREE shipping!
    </div>
  {% endif %}

  <div class="shelzy-shipping-progress">
    <div class="shelzy-shipping-progress-fill" style="width: {{ progress_percent }}%"></div>
  </div>
</div>
