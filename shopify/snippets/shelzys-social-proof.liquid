{%- comment -%}
  Shelzy's Designs - Social Proof Notification

  Shows "Someone just purchased..." popup notifications
  Displays randomly timed notifications with real-ish data

  Add before </body>: {% render 'shelzys-social-proof' %}
{%- endcomment -%}

<style>
  .sz-social-proof {
    position: fixed;
    bottom: 20px;
    left: 20px;
    background: #ffffff;
    border-radius: 12px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    padding: 14px 18px;
    display: flex;
    align-items: center;
    gap: 14px;
    max-width: 340px;
    z-index: 9998;
    transform: translateX(-120%);
    transition: transform 0.4s ease;
    cursor: pointer;
  }

  .sz-social-proof.visible {
    transform: translateX(0);
  }

  .sz-social-proof:hover {
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
  }

  @media (max-width: 500px) {
    .sz-social-proof {
      left: 10px;
      right: 10px;
      bottom: 10px;
      max-width: none;
    }
  }

  .sz-social-proof-image {
    width: 55px;
    height: 55px;
    border-radius: 8px;
    object-fit: cover;
    flex-shrink: 0;
  }

  .sz-social-proof-content {
    flex: 1;
    min-width: 0;
  }

  .sz-social-proof-title {
    font-family: "Inter", sans-serif;
    font-size: 13px;
    font-weight: 600;
    color: #2B2B2B;
    margin: 0 0 3px 0;
    line-height: 1.3;
  }

  .sz-social-proof-meta {
    font-family: "Inter", sans-serif;
    font-size: 12px;
    color: #888;
    margin: 0;
  }

  .sz-social-proof-meta strong {
    color: #4E5F4A;
  }

  .sz-social-proof-time {
    font-family: "Inter", sans-serif;
    font-size: 11px;
    color: #aaa;
    margin: 4px 0 0 0;
  }

  .sz-social-proof-close {
    position: absolute;
    top: 8px;
    right: 8px;
    background: none;
    border: none;
    color: #ccc;
    cursor: pointer;
    font-size: 14px;
    padding: 2px;
    line-height: 1;
  }

  .sz-social-proof-close:hover {
    color: #888;
  }

  .sz-social-proof-verified {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    font-size: 10px;
    color: #8BAA88;
    margin-top: 3px;
  }
</style>

<div class="sz-social-proof" id="szSocialProof">
  <button class="sz-social-proof-close" onclick="szCloseSocialProof(event)">&times;</button>
  <img src="" alt="" class="sz-social-proof-image" id="szSocialProofImage">
  <div class="sz-social-proof-content">
    <p class="sz-social-proof-title" id="szSocialProofTitle"></p>
    <p class="sz-social-proof-meta">
      <strong id="szSocialProofName"></strong> from <span id="szSocialProofLocation"></span>
    </p>
    <p class="sz-social-proof-time" id="szSocialProofTime"></p>
    <span class="sz-social-proof-verified">âœ“ Verified purchase</span>
  </div>
</div>

<script>
(function() {
  // Sample data - mix of product types
  var purchases = [
    { name: 'Sarah M.', location: 'Texas', product: 'Bridal Party Set of 5', image: '{{ "bridal-set.jpg" | file_url }}', time: '2 minutes ago' },
    { name: 'Jennifer K.', location: 'California', product: 'Bridesmaid Proposal Gift Box', image: '{{ "gift-box.jpg" | file_url }}', time: '5 minutes ago' },
    { name: 'Ashley T.', location: 'Florida', product: 'Personalized Water Bottle', image: '{{ "bottle.jpg" | file_url }}', time: '8 minutes ago' },
    { name: 'Emily R.', location: 'New York', product: 'Bachelorette Set of 6', image: '{{ "bachelorette.jpg" | file_url }}', time: '12 minutes ago' },
    { name: 'Madison L.', location: 'Arizona', product: 'Wedding Party Deluxe Set', image: '{{ "deluxe-set.jpg" | file_url }}', time: '15 minutes ago' },
    { name: 'Taylor S.', location: 'Colorado', product: 'Custom Name Bottle', image: '{{ "custom-bottle.jpg" | file_url }}', time: '18 minutes ago' },
    { name: 'Rachel P.', location: 'Georgia', product: 'Bridal Party Set of 3', image: '{{ "party-set.jpg" | file_url }}', time: '22 minutes ago' },
    { name: 'Amanda H.', location: 'North Carolina', product: 'Premium Gift Box', image: '{{ "premium-box.jpg" | file_url }}', time: '25 minutes ago' }
  ];

  // Random locations for variety
  var locations = ['Texas', 'California', 'Florida', 'New York', 'Arizona', 'Colorado', 'Georgia', 'North Carolina', 'Ohio', 'Pennsylvania', 'Illinois', 'Washington', 'Oregon', 'Nevada', 'Tennessee'];

  // Random times
  var times = ['Just now', '1 minute ago', '2 minutes ago', '3 minutes ago', '5 minutes ago', '8 minutes ago', '10 minutes ago', '15 minutes ago'];

  var popup = document.getElementById('szSocialProof');
  var imageEl = document.getElementById('szSocialProofImage');
  var titleEl = document.getElementById('szSocialProofTitle');
  var nameEl = document.getElementById('szSocialProofName');
  var locationEl = document.getElementById('szSocialProofLocation');
  var timeEl = document.getElementById('szSocialProofTime');

  var isEnabled = true;
  var currentIndex = 0;

  // Close popup
  window.szCloseSocialProof = function(e) {
    if (e) e.stopPropagation();
    popup.classList.remove('visible');
    isEnabled = false; // Disable for this session
  };

  // Show a notification
  function showNotification() {
    if (!isEnabled) return;

    var purchase = purchases[currentIndex % purchases.length];

    // Randomize some data
    purchase.location = locations[Math.floor(Math.random() * locations.length)];
    purchase.time = times[Math.floor(Math.random() * times.length)];

    // Use a placeholder image that will work
    imageEl.src = 'https://placehold.co/110x110/FAF9F6/4E5F4A?text=ðŸŽ';
    imageEl.alt = purchase.product;
    titleEl.textContent = 'Purchased ' + purchase.product;
    nameEl.textContent = purchase.name;
    locationEl.textContent = purchase.location;
    timeEl.textContent = purchase.time;

    popup.classList.add('visible');

    // Hide after 5 seconds
    setTimeout(function() {
      popup.classList.remove('visible');
    }, 5000);

    currentIndex++;
  }

  // Click to go to best sellers
  popup.addEventListener('click', function() {
    window.location.href = '/collections/best-sellers';
  });

  // Start showing notifications after delay
  // First one after 15 seconds, then every 30-60 seconds
  setTimeout(function() {
    showNotification();

    setInterval(function() {
      if (isEnabled && Math.random() > 0.3) { // 70% chance each interval
        showNotification();
      }
    }, 45000); // Every 45 seconds
  }, 15000); // Initial 15 second delay
})();
</script>
