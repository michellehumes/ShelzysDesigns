{% comment %}
  Product Page: Reviews Above the Fold

  Displays star rating and review count near the product price
  to provide social proof at the decision-making moment.

  Expected Impact: +8-12% Add to Cart rate

  Installation:
  Add this snippet to your product template (product-template.liquid)
  Place it right below the product price section

  Usage: {% render 'product-reviews-above-fold', product: product %}
{% endcomment %}

{% comment %}
  For Shopify Product Reviews App
  This will work with the built-in Shopify reviews app
{% endcomment %}

<div class="product-reviews-summary" style="margin: 15px 0; padding: 15px 0; border-top: 1px solid #e9ecef; border-bottom: 1px solid #e9ecef;">
  <div id="shopify-product-reviews-summary" data-id="{{ product.id }}"></div>

  {% comment %} Fallback if reviews app not installed {% endcomment %}
  <div class="reviews-fallback" style="display: flex; align-items: center; gap: 10px;">
    <div class="stars" style="color: #ffc107; font-size: 20px; letter-spacing: 2px;">
      ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
    </div>
    <div class="review-count" style="font-size: 14px; color: #666;">
      <strong style="color: #1a1a1a;">4.9</strong> (500+ reviews)
    </div>
    <a href="#reviews" class="review-link" style="font-size: 14px; color: #d4a574; text-decoration: none; font-weight: 600; margin-left: 10px;">
      Read Reviews ‚Üí
    </a>
  </div>
</div>

{% comment %} Alternative: For Judge.me or Loox Apps {% endcomment %}
<div class="product-reviews-badge" style="margin: 15px 0;">
  {% comment %} Judge.me widget {% endcomment %}
  <div class="jdgm-widget jdgm-preview-badge"
       data-id="{{ product.id }}"
       style="display: flex; align-items: center; justify-content: flex-start;">
    {{ product.metafields.judgeme.badge }}
  </div>

  {% comment %} Loox widget {% endcomment %}
  <div class="loox-rating"
       data-id="{{ product.id }}"
       data-rating="{{ product.metafields.loox.avg_rating }}"
       data-raters="{{ product.metafields.loox.num_reviews }}">
  </div>
</div>

{% comment %} Trust Badges Below Reviews {% endcomment %}
<div class="product-trust-badges" style="display: flex; flex-wrap: wrap; gap: 20px; margin: 15px 0; align-items: center;">
  <div class="trust-badge" style="display: flex; align-items: center; gap: 8px; font-size: 13px; color: #666;">
    <span style="font-size: 18px;">‚úì</span>
    <span><strong style="color: #1a1a1a;">Free Shipping</strong> on $50+</span>
  </div>
  <div class="trust-badge" style="display: flex; align-items: center; gap: 8px; font-size: 13px; color: #666;">
    <span style="font-size: 18px;">‚è±Ô∏è</span>
    <span><strong style="color: #1a1a1a;">Ships in 5-7 Days</strong></span>
  </div>
  <div class="trust-badge" style="display: flex; align-items: center; gap: 8px; font-size: 13px; color: #666;">
    <span style="font-size: 18px;">üîÑ</span>
    <span><strong style="color: #1a1a1a;">Easy Returns</strong></span>
  </div>
</div>

{% comment %} Custom Star Rating Display (if no review app) {% endcomment %}
<div class="custom-rating" style="margin: 15px 0; display: flex; align-items: center; gap: 12px;">
  <div class="stars-display" style="display: flex; gap: 3px;">
    {% for i in (1..5) %}
      <svg width="20" height="20" viewBox="0 0 20 20" fill="#ffc107" xmlns="http://www.w3.org/2000/svg">
        <path d="M10 0L12.9389 6.90983L20 8.09017L15 13.0902L16.1803 20L10 16.9098L3.81966 20L5 13.0902L0 8.09017L7.06107 6.90983L10 0Z"/>
      </svg>
    {% endfor %}
  </div>
  <div class="rating-text" style="font-size: 14px; color: #666;">
    <strong style="color: #1a1a1a; font-size: 16px;">4.9 out of 5</strong>
  </div>
  <div class="review-count" style="font-size: 14px; color: #666;">
    Based on <strong style="color: #1a1a1a;">500+</strong> reviews
  </div>
</div>

{% comment %} Highlighted Review Snippet {% endcomment %}
<div class="featured-review" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 3px solid #d4a574;">
  <div class="review-stars" style="color: #ffc107; font-size: 14px; margin-bottom: 8px;">
    ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
  </div>
  <p style="font-size: 14px; color: #333; margin: 0 0 10px 0; font-style: italic; line-height: 1.5;">
    "These bottles were the perfect bridesmaid gift! Everyone loved the personalization and the quality is amazing. They're still using them months later!"
  </p>
  <div style="font-size: 13px; color: #666;">
    <strong style="color: #1a1a1a;">Sarah M.</strong> - Verified Buyer
  </div>
</div>

{% comment %} Smooth scroll to full reviews section {% endcomment %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  const reviewLinks = document.querySelectorAll('a[href="#reviews"]');
  reviewLinks.forEach(link => {
    link.addEventListener('click', function(e) {
      e.preventDefault();
      const reviewsSection = document.getElementById('reviews') ||
                            document.querySelector('.spr-reviews') ||
                            document.querySelector('.jdgm-rev-widg');
      if (reviewsSection) {
        reviewsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    });
  });
});
</script>

{% comment %}
  A/B Test Setup:

  Variant A (Control): Reviews below fold (current state)
  Variant B (Test): Reviews above fold (this snippet)

  Hypothesis: Moving reviews near Add to Cart button increases trust
  and conversion by making social proof more visible at decision moment.

  Expected lift: +8-12% Add to Cart rate

  How to test:
  1. Run for 2 weeks minimum
  2. Need 2,000+ product page views per variant
  3. Measure Add to Cart rate from product page
  4. Use Google Optimize or manual weekly rotation
  5. Statistical significance calculator: https://abtestguide.com/calc/
{% endcomment %}
